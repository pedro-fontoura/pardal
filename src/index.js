function t(t){return t.concat()}function s(i,h){var e,n;for(e in i)n=i[e],h.hasOwnProperty(e)&&(n instanceof Array?h[e]=t(n):n instanceof Object?s(n,h[e]):h[e]=n)}function i(t){for(var s=t.length-1;s>0;s--){var i=Math.floor(Math.random()*(s+1)),h=t[s];t[s]=t[i],t[i]=h}}function h(t,s=null,i=!1){var h=new URL(window.location).searchParams.get(t);return null===h?h=s:i&&(h=parseInt(h,10)),h}function e(t,s,i){t.setHex(s),t.r+=Math.F2(-i,i)%1,t.g+=Math.F2(-i,i)%1,t.b+=Math.F2(-i,i)%1}function n(s,i){var h,e;for(h in s)e=s[h],i.hasOwnProperty(h)&&(e instanceof Object?n(e,i[h]):i[h]=e instanceof Array?t(e):e)}import*as r from"three";import*as a from"cannon";Math.TWO_PI=2*Math.PI,Math.HALF_PI=Math.PI/2,Math.F3=function(t,s,i,h){return Math.F4(t-i,s-h)},Math.F4=function(t,s){return Math.sqrt(t*t+s*s)},Math.F2=function(t,s){return t+Math.random()*(s-t)},Math.PI_OVER_180=Math.PI/180,Math.PI_UNDER_180=180/Math.PI,Math.F6=function(t){return t*Math.PI_OVER_180},Math.F5=function(t){for(;t<-Math.PI;)t+=Math.TWO_PI;for(;t>Math.PI;)t-=Math.TWO_PI;return t},Math.F1=function(t=.5){return Math.random()<=t%1};var o=0;const l=12,c=16;class u{NA=0;NR=0;R=0;LST_A=null;LST_R=null;LST_P=null;SIZE=0;idx_p=0;pair=[0,0];constructor(t,s,i){this.NA=t,this.NR=s,this.R=i,this.SIZE=t*s,this.LST_A=new Array(t),this.LST_R=new Array(s),this.LST_P=new Array(this.SIZE),this.M149(),this.M124()}M149(){var t,s,i=0,h=Math.TWO_PI/this.NA;for(t=0;t<this.NA;t+=1,i+=h)this.LST_A[t]=i;for(h=this.R/this.NR,i=this.R,s=0;i>=0;)this.LST_R[s]=i,i-=h,s+=1;for(i=0,t=0;t<this.NA;t++)for(s=0;s<this.NR;s++)this.LST_P[i++]=[this.LST_A[t],this.LST_R[s]]}M124(){i(this.LST_P),this.idx_p=0}M125(){return this.idx_p<this.SIZE?this.LST_P[this.idx_p++]:null}}const M=navigator.maxTouchPoints>0,d=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,p=function(){document.fullscreenElement||document.documentElement.requestFullscreen instanceof Function&&document.documentElement.requestFullscreen({navigationUI:"hide"})},_=function(t){t.removeFromParent(),t.geometry.dispose(),t.material.dispose()},m="undefined"!=typeof DEV&&DEV;class y{id=0;talkback=null;mesh=null;trigger_body=null;local_x=0;local_z=0;radius=0;type=0;block_tx=null;block_ty=null;block_tz=null;visible=!1;constructor(t,s,i,h,e,n){this.talkback=t,this.id=s,this.local_x=i,this.local_z=h,this.radius=e,this.type=n}get ID(){return this.id}get LocalX(){return this.local_x}get LocalZ(){return this.local_z}get RADIUS(){return this.radius}get VISIBLE(){return this.visible}get TY(){return this.block_ty}M141(t){this.mesh.visible=!t}M126(t=0){this.trigger_body.TargetCode=t}M127(t,s=null){null===s?this.mesh=t:(this.mesh=new r.Mesh(t,s),this.mesh.visible=!1),this.talkback(c,{mesh:this.mesh})}M79(t){this.trigger_body=new a.Body({isTrigger:!0,collisionFilterGroup:8,collisionFilterMask:1}),this.trigger_body.addShape(t),this.trigger_body.addEventListener("collide",(t=>{this.talkback(3,{position:this.trigger_body.position,type:this.type,code:this.trigger_body.TargetCode})})),this.talkback(2,{body:this.trigger_body})}M8(t,s,i){this.trigger_body.position.set(t+this.local_x,s+this.radius,i+this.local_z),this.mesh.position.copy(this.trigger_body.position),this.talkback(6,{position:this.trigger_body.position})}M15(t,s,i){if(null!==this.block_tx||null!==this.block_tz)return this.visible=this.block_tx===t&&this.block_tz===i,this.mesh.visible=this.visible,this.visible?s===this.block_ty?1:-1:0;this.block_tx=t,this.block_ty=s,this.block_tz=i,this.mesh.visible=!0}M128(){this.talkback(4,{body:this.trigger_body}),this.trigger_body=null,this.mesh.removeFromParent(),this.mesh.material.dispose(),this.mesh.geometry.dispose(),this.mesh.clear(),this.mesh=null,this.talkback=null}M135(){}}class g{#t=0;#s=null;#i=null;#h=!0;#e=0;#n=0;#r="";#a="";#o=null;#l=-1;constructor(){this.#s=eById("pages_container"),this.#i=eById("Menu"),this.#t=this.#s.children.length,this.#c(null),eById("pages_wrapper").classList.remove("hidden"),this.M106(!1),this.#u(),setTimeout((()=>{eById("Menu").classList.remove("hidden")}),500),this.M81();const t=eById("home_title");this.M45(t).then((s=>{if(null!==s){const i=this.M16(t,s);this.#a=i.q_lang||"NONE",this.M23(),eById("play").addEventListener("click",(()=>{eById("play").blur(),this.M91(i)})),h("play",0,!0)&&this.M91(i)}}))}#u(){window.addEventListener("resize",this.#c.bind(this),!1),eById("MenuIcon").addEventListener("click",this.M80.bind(this),!1),Array.from(this.#i.children).forEach((t=>{t.addEventListener("click",(s=>{this.M107(this.#M(t.dataset.page))}))})),eById("tts_select_rate").addEventListener("change",(t=>{eById("txt_rate").innerHTML=t.target.value,null!==this.#o&&this.#o.M84(parseFloat(t.target.value,10))})),eById("tts_select_rate").addEventListener("mousemove",(t=>{eById("txt_rate").innerHTML=t.target.value})),eById("btn_full_screen").addEventListener("click",(t=>{p()}))}M106(t){this.#h=t,this.#i.style.left=(this.#h?0:-this.#i.offsetWidth)+"px"}M80(t){this.M106(!this.#h)}#c(t){const s=window.visualViewport.width,i=window.visualViewport.height,h=eById("pages_wrapper");h.style.width=s+"px",h.style.height=i+"px",this.#e=s,this.#s.style.width=this.#t*(s+2)+"px",Array.from(this.#s.children).forEach((t=>{t.style.width=s+"px",t.style.height=i+"px"})),eById("Menu").style.height=i+"px",this.M107(this.#n),this.M106(this.#h)}M107(t){this.#s.style.left=-t*this.#e+"px",this.#n=t,t!==this.#M("GamePage")&&this.M92(!0)}M81(){return this.#r=h("id","teste"),this.#r}M53(){return"./quizzes/quizz-"+this.#r+".txt"}M45(t){t.innerHTML="Loading: "+this.#r+" ...";const s=t;return fetch(this.M53()).then((t=>{if(t.ok)return t.text();throw t})).catch((t=>(s.innerHTML+=" "+t.statusText,null)))}M21(t){var s=t.questions;return s=LZString.decompressFromEncodedURIComponent(s),s=JSON.parse(s),t.questions=s,t}M108(t){const s=new Date(parseInt(t,10));return[s.getDate(),1+s.getMonth(),s.getFullYear()].join(".")}M22(t){var s={};return t.split("\n").forEach((t=>{(t=t.trim()).length>0&&(t=t.split("="),s[t[0]]=t[1]||"")})),s}M16(t,s){window.document.title+=": "+this.#r;const i=this.M22(s);t.innerHTML=i.title,eById("quizz_length").innerHTML=i.questions.length,eById("quizz_date").innerHTML=this.M108(i.timestamp);const h=["q_field","q_subject","q_chapter","q_year","q_level"],e=["Área","Disciplina","Tema","Ano","Nível"],n=eById("quizz_info");var r;for(r in i){if("questions"===r)continue;var a;if(null!==(a=eById("quizz_"+r))){a.innerHTML=i[r];continue}var o=i[r];o.length;var l=parseInt(o,10);isNaN(l)||(o=l);const t=h.indexOf(r);t>=0&&((a=document.createElement("p")).innerHTML=e[t]+"<span>"+o+"</span>",n.appendChild(a))}return i}#M(t){return Array.from(this.#s.children).indexOf(eById(t))}M91(t){M&&(d||p()),this.M106(!1),this.M107(this.#M("GamePage")),eById("tts_select_voices").style.opacity="0.3",eById("tts_select_voices").style.pointerEvents="none",null===this.#o?(this.#o=new I(this.M21(t),this.#l,parseFloat(eById("tts_select_rate").value,10)),m&&(globalThis.game=this.#o)):this.M92(!1)}M92(t){null!==this.#o&&this.#o.M144(t)}M23(){"string"==typeof this.#a&&this.#a.length>=2&&(this.M93(),void 0!==speechSynthesis.onvoiceschanged&&(speechSynthesis.onvoiceschanged=this.M93.bind(this)))}M93(){const t=window.speechSynthesis.getVoices(),s=eById("tts_select_voices");s.addEventListener("change",(t=>{this.#l=parseInt(t.target.selectedOptions[0].getAttribute("data-idx"),10)}));var i,h=0;for(i of t)if(i.lang.split("-").includes(this.#a)){const t=document.createElement("option");t.textContent=i.lang+" - "+i.name,t.setAttribute("data-idx",h),s.appendChild(t),(i.default||this.#l<0)&&(this.#l=h),h+=1}}}class f{#d=null;#p=0;#_=0;#m=0;#y=0;#g=0;#f=0;#w=0;#b=0;#v=0;#x=0;#L=0;#I=0;#E=0;#k=0;#S=!1;#z=0;#q=0;constructor(t,s,i){this.#d=t,this.#y=this.#v=s,this.#z=this.#_=this.#w=i,this.#E=this.#x=.5*i}M54(t,s,i){this.#I=t,this.#k=s,this.#g=Math.PI-i,this.#f=this.#p=t+this.#y*Math.cos(this.#g),this.#b=this.#m=s+this.#y*Math.sin(this.#g),this.M55()}M11(t,s,i){this.#I=t,this.#k=s,this.#g=Math.PI-i,this.#f=t+this.#y*Math.cos(this.#g),this.#b=s+this.#y*Math.sin(this.#g),this.#S=!0}M94(t){this.#w=t}M24(t){this.#q=t,this.#w=this.#q+this.#z,this.#x=this.#q+.5*this.#z}M134(t){this.#v=t}M46(t){this.#L=this.#x,this.#x=this.#q+t}M12(){this.#x=this.#q+this.#L}M135(){if(this.#S){this.#S=!1;const n=.05;var t=this.#v-this.#y;Math.abs(t)>.01&&(this.#S=!0,this.#y+=t*n,this.#f=this.#I+this.#y*Math.cos(this.#g),this.#b=this.#k+this.#y*Math.sin(this.#g));var s=this.#f-this.#p,i=this.#w-this.#_,h=this.#b-this.#m,e=this.#x-this.#E;Math.abs(s)>.01&&(this.#S=!0,this.#p+=s*n),Math.abs(h)>.01&&(this.#S=!0,this.#m+=h*n),Math.abs(i)>.01&&(this.#S=!0,this.#_+=i*n),Math.abs(e)>.01&&(this.#S=!0,this.#E+=.025*e),this.#S&&this.M55()}}M55(){this.#d.position.x=this.#p,this.#d.position.y=this.#_,this.#d.position.z=this.#m,this.#d.lookAt(this.#I,this.#E,this.#k)}}const w=Math.TWO_PI/3,b=w/2,v=[0,w,-w];class x{#T=null;#O=null;#g=0;#A=new Array(3);#P=null;#G=0;#V=null;#F=null;#R=0;#B=0;#H=null;#N=!1;#C=1;#D=.03;#Y={active:!1,position:new r.Vector3,e_radar:null,e_dtt:null,e_dtt_percent:null,e_radar_section:null,max_dst:0,status:-1};#X=0;#Z=null;#W=new r.Vector3;collisions={terrain_center_change:0,terrain:0,rock:0};#U=0;constructor(t){this.#V=t,this.#T=new r.Object3D,this.#V(c,{mesh:this.#T}),this.#j(new r.MeshLambertMaterial({color:6396905})),this.#K(),this.#Y.e_radar=document.getElementById("radar"),this.#Y.e_dtt=document.getElementById("dtt"),this.#Y.e_dtt_percent=document.getElementById("dtt_percent"),this.#Y.e_radar_section=document.getElementById("radar_section"),this.#Z=document.getElementById("dst")}get CONTAINER(){return this.#T}get X(){return this.#T.position.x}get Y(){return this.#T.position.y}get Z(){return this.#T.position.z}get ANGLE(){return this.#g}get POSITION(){return this.#T.position}M136(t){this.#D=.03*60/t}#j(t){const s=new r.BoxGeometry(1,1,1);this.#O=new r.Mesh(s,t),this.#O.position.set(0,0,0),this.#O.castShadow=!0,this.#T.add(this.#O);const i=.33,h=new r.BoxGeometry(i,i,i),e=new r.Mesh(h,t);e.position.set(.375,.5,.033-.5),this.#O.add(e);const n=e.clone();e.position.set(.375,.5,.4175),this.#O.add(n);const o=new r.BoxGeometry(1.33,.2,.2),l=new r.Mesh(o,t);l.position.set(-1.25,0,0),this.#O.add(l),this.#H=new L(1,t),this.#O.add(this.#H.S11),this.#O.add(this.#H.S10),this.#P=new a.Body({mass:1,shape:new a.Sphere(.55),collisionFilterGroup:1,collisionFilterMask:14}),this.#P.addEventListener("collide",this.#J.bind(this))}#J(t){const s=t.body,i=t.contact,h=s.collisionFilterGroup;return 2===h?this.#Q(s,i):4===h?this.#$(s,i):void 0}#Q(t,s){const i=Date.now();if(i-this.collisions.terrain_center_change<20)return;this.collisions.terrain=i;const h=s.getImpactVelocityAlongNormal();h<1||this.#V(7,{n:Math.round(h),p:this.#P.position.y-this.#G>.1?this.#P.position:null})}#$(t,s){const i=Date.now();var h=i-this.collisions.rock;if(this.collisions.rock=i,h<50)return;const e=s.getImpactVelocityAlongNormal();this.collisions.rock=i,this.#V(8,{n:Math.round(e)||1,p:this.#P.position,hc:t.HEX_COLOR})}M95(t=null){return null===t?(this.#Y.active=!1,this.#Y.e_dtt.innerText="",this.#Y.e_radar_section.classList.add("hidden"),this.#Y.max_dst=0,this.#Y.status=-1,0):(this.#Y.active=!0,this.#Y.position.set(t.x,t.y,t.z),0===this.#Y.max_dst&&(this.#Y.max_dst=Math.ceil(this.#P.position.distanceTo(this.#Y.position))),setTimeout((t=>{this.#Y.e_radar_section.classList.remove("hidden")}),160),this.#Y.max_dst)}#K(){this.#F=new S("character",S.S5,100,{sprite:"./images/spark1.png",color:1727412}),this.#V(c,{mesh:this.#F.CONTAINER})}M62(t,s,i,h,e,n){const r=this.#P.velocity.y>=-.1&&Math.abs(this.#T.position.y-.5-this.#G)<.6;if(this.#H.M135(),r?this.#H.M142():this.#H.M150(),this.#T.position.copy(this.#P.position),this.#F.M135(s),this.#N)this.#P.velocity.x=this.#P.velocity.z=0,0!==this.#O.rotation.x&&(this.#O.rotation.x+=this.#O.rotation.x<0?.01:-.01);else{if(this.#X+=this.#P.position.distanceTo(this.#W),this.#Z.innerText=Math.round(this.#X),this.#W.copy(this.#P.position),this.#P.position.y<-4&&(this.#P.position.y=20,this.#tt(15),this.#V(10,--this.#U),0===this.#U&&this.#Y.active&&this.M95(null),0===this.#U&&this.#T.removeFromParent()),this.#P.velocity.y>20&&(this.#P.velocity.y=20),this.#P.velocity.length()>20&&this.#st(.95),i){const t=8;this.#P.velocity.x=t*Math.cos(this.#g),this.#P.velocity.z=-t*Math.sin(this.#g)}else this.#P.velocity.x*=.95,this.#P.velocity.z*=.95;h||e?(this.#g+=this.#D*(h?1:-1),this.#T.rotation.y=this.#g,this.#tt(),Math.abs(this.#O.rotation.x)<.26&&(this.#O.rotation.x+=.01*(h?-1:1))):0!==this.#O.rotation.x&&(this.#O.rotation.x+=this.#O.rotation.x<0?.01:-.01),this.#Y.active&&this.#it(),n&&r&&t-this.#B>1e3&&(this.#P.velocity.y=Math.max(6,.9*Math.abs(this.#P.velocity.y)),this.#V(9)),i&&t-this.#R>=80&&(this.#R=t,this.#F.M34(this.#T.position.x,this.#T.position.y,this.#T.position.z))}}#st(t=0){0===t?(this.#P.velocity.setZero(),this.#P.angularVelocity.setZero()):this.#P.velocity.scale(t,this.#P.velocity)}M2(){return Math.round(this.#X)}#tt(t=0){const s=0===t?this.#P.velocity.length():t;this.#P.velocity.x=s*Math.cos(this.#g),this.#P.velocity.z=-s*Math.sin(this.#g)}M96(t){this.#C=t}#it(){const t=Math.atan2(this.#Y.position.x-this.#T.position.x,this.#Y.position.z-this.#T.position.z),s=Math.F5(t-Math.HALF_PI),i=Math.F5(this.#g),h=-Math.F5(s-i),e=this.#P.position.distanceTo(this.#Y.position);if(e<=this.#C)-2!==this.#Y.status&&(this.#Y.status=-2,this.#Y.e_radar_section.classList.add("close"),this.#Y.e_dtt.innerHTML="(&bull;)",this.#V(11));else{this.#Y.status<0&&this.#Y.e_radar_section.classList.remove("close"),this.#Y.e_dtt.innerText=Math.round(e);var n,r,a,o=100;for(e<this.#Y.max_dst?o=Math.round(e/this.#Y.max_dst*100):this.#Y.max_dst=e,this.#Y.e_dtt_percent.style.width=o+"%",n=0;n<3;n++)if((r=v[n])-b<h&&h<r+b&&this.#Y.status!==n){this.#Y.status=n,a="rotate("+r+"rad)",this.#Y.e_radar_section.style.transform=a,this.#V(11);break}}}M25(t){this.#G=t,this.collisions.terrain_center_change=Date.now()}M63(t,s,i,h=null){this.#P.position.set(t,s+.5,i),this.#W.copy(this.#P.position),this.#V(2,{body:this.#P}),null!==h&&(this.#g=h,this.#T.rotation.y=this.#g),this.#G=s}M26(){return this.#A[0]=this.#T.position.x,this.#A[1]=this.#T.position.z,this.#A[2]=this.#g,this.#A}M47(t=null,s=0,i){if(this.#N=null!==t,this.#N){const s=this.#P.velocity.y;this.#st(0),this.#P.velocity.y=s,t[1]+=.5,this.M63(...t),this.#F.M101()}else this.#P.velocity.y=10*s,this.#B=i}M13(t,s){13!==t||(this.#g=this.#T.rotation.y=s.angle)}M109(t){this.#U=t>0?t:1/0}}class L{#ht=null;#et=null;#nt=!1;#rt=0;#at=Math.PI/2/10;constructor(t,s){const i=s.clone(),h=new r.Shape;h.moveTo(.5*t,-.2*t),h.lineTo(2.5*t,-t),h.lineTo(.5*t,-t),h.lineTo(.5*t,-.2*t);const e=new r.ShapeGeometry(h);e.rotateY(-Math.PI/2),e.rotateZ(-Math.PI/2),e.translate(t/2,0,0),e.rotateY(-Math.PI/2.3),this.#et=new r.Mesh(e,i);const n=e.clone();n.rotateX(Math.PI);const a=s.clone();a.side=r.BackSide,this.#ht=new r.Mesh(n,a)}get S11(){return this.#ht}get S10(){return this.#et}M150(){this.#nt||(this.#nt=!0)}M142(){this.#nt&&(this.#nt=!1)}M135(){var t=!1;this.#nt&&this.#rt<Math.HALF_PI&&(t=!0,this.#rt+=this.#at),!this.#nt&&this.#rt>0&&(t=!0,this.#rt-=this.#at),t&&(this.#et.rotation.y=this.#rt,this.#ht.rotation.y=-this.#rt)}}class I{three=null;world=null;sun={light:null,dx:0,dy:0,dz:0};lst_rm_bodies=[];gnd_particle_system=null;#ot=0;score_quizz=0;#lt=null;#ct=null;#ut=null;#Mt=null;quizz_data=null;question_idx=-1;quizz_length=0;target_cnt=0;target_code=0;target_cell_dst=1;target_min_dtt=.5;dead=!1;paused=!1;#dt=null;#pt=!1;#_t=!1;#mt=!1;#yt=!1;#gt=0;tts=null;question=!1;sound=null;#ft=null;constructor(t,s=-1,i){this.M16(t),this.quizz_data.q_lang&&s>=0&&(this.tts=new $(this.quizz_data.q_lang,s,i)),this.M49(),this.M83().then((t=>{t&&this.M137()}))}M137(){globalThis.RADIAL_GRID=new u(100,100,20),this.M149(),this.M143()}M149(){this.M97(),this.M82(),M&&this.M98(),this.terrain=new D(this.M111.bind(this),3,3,20),this.terrain.M102(0,0),this.character=new x(this.M111.bind(this));const t=this.terrain.M42();t[1]=2,this.character.M63(...t,-Math.PI/2),this.character.M25(this.terrain.M89()),this.character.M96(Math.round(20*this.target_min_dtt)),this.character.M109(o),this.camera=new f(this.three.S8,20,15),this.M6(),this.#wt(o),this.#lt=eById("fps"),this.#ct=eById("score_quizz"),this.#ut=eById("score_quizz_percent"),this.#Mt=eById("score_question"),this.#Mt.style.visibility="visible"}M143(){this.three.M19(this.M48.bind(this),this.M145.bind(this)),this.M100(1e3),this.three.M10()}M97(){this.three=new J({canvas:{id:"c"},auto_resize:!0,grid:[0,0],axes:0,camera:{position:[10,10,10]},renderer:{shadow:2}}),this.three.M18(this.M110.bind(this)),this.three.M61(["ArrowUp","KeyW","ArrowLeft","KeyA","ArrowRight","KeyD","Space","KeyB"]),this.three.M90(new r.HemisphereLight(16777215,0,.1));const t=new r.DirectionalLight(16777215,.95);t.position.set(150,350,350),t.castShadow=!0,t.shadow.camera.left=-400,t.shadow.camera.right=400,t.shadow.camera.top=400,t.shadow.camera.bottom=-400,t.shadow.camera.near=1,t.shadow.camera.far=550,t.shadow.bias=.001,t.target.position.set(0,0,0),t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,this.three.M90(t),this.three.M90(t.target),this.sun.light=t,this.sun.dx=t.position.x,this.sun.dy=t.position.y,this.sun.dz=t.position.z}M82(){this.world=new a.World({gravity:new a.Vec3(0,-8,0)}),this.world.defaultContactMaterial.friction=.25,this.world.defaultContactMaterial.restitution=.6}M98(){d||p(),this.#dt=new Q}M83(){return this.sound=new C,this.sound.M122([["touch_gnd","click-0.mp3"],["touch_trigger","fx-204.mp3"],["touch_question","RR_internaut_lift_pyramid.mp3"],["touch_rock","click-1.mp3"],["jump","clack.mp3"],["fall","KK_heartbreak.mp3"],["radar","beep-21.mp3"],["wrong","KK_bully_bounce_-5.mp3"],["correct","RR_wohoo_1.mp3"],["firework-explosion","firework-explosion-1.mp3"],["death","kl-music-box-game-over-iii-152202.mp3"],["timer","kitchen-timer-55420.mp3"],["no_answer","Quick-Fart-SoundBible-655578646.mp3"]],"./sounds/").then((t=>!0)).catch((t=>!1))}M16(t){this.quizz_data=t;var s=parseInt(this.quizz_data.lives,10);isNaN(s)||(o=s),this.question_idx=0,this.quizz_length=this.quizz_data.questions.length,i(this.quizz_data.questions)}M110(t,s){this.terrain.M110(t,s)}M99(t){return this.sound.M156(t)}M144(t){this.paused!==t&&(t?this.three.M14():this.three.M10(),this.paused=t,null!==this.#dt&&this.#dt.M155(!t))}M145(t){if("number"==typeof t)this.#lt.innerText=t,this.character.M136(t),this.question&&this.terrain.M72("fps",t);else{this.#lt.innerText=t?"START":"STOP",this.paused=!t,this.M129(t);const s=eById("QuestionZone");s&&s.classList[t?"add":"remove"]("visible")}}t=0;M48(t,s){if(!this.dead){this.world.fixedStep(),M?(this.#mt=this.#dt.M105(Q.S4),this.#pt=this.#dt.M105(Q.S11),this.#_t=this.#dt.M105(Q.S10),this.#yt=this.#dt.M105(Q.S12)):(this.#mt=this.three.M132("ArrowUp")||this.three.M132("KeyW"),this.#pt=this.three.M132("ArrowLeft")||this.three.M132("KeyA"),this.#_t=this.three.M132("ArrowRight")||this.three.M132("KeyD"),this.#yt=this.three.M132("Space")),this.character.M62(t,s,this.#mt,this.#pt,this.#_t,this.#yt);var i=this.character.M26();if(this.camera.M11(...i),this.camera.M135(),!M&&!this.#mt&&!this.question&&t-this.t>200){this.t=t;const s=this.character.POSITION;this.ps_snow.M146(1,s.x,s.y+20,s.z,Math.F2(4,6)/1e3,null,0)}null!==(i=this.terrain.M41(...i))&&(this.#ot=i[1],this.character.M25(i[1]),this.camera.M24(i[1]),this.sun.light.position.set(this.sun.dx+i[0],this.sun.dy,this.sun.dz+i[2]),this.sun.light.target.position.set(this.sun.light.position.x-this.sun.dx,0,this.sun.light.position.z-this.sun.dz)),this.terrain.M135(this.#pt,this.#_t,this.#yt,this.#mt),this.#bt(s),this.#vt()&&this.M64()}}#vt(){for(var t,s=!1;this.lst_rm_bodies.length>0;)1===(t=this.lst_rm_bodies.pop()).TargetCode&&(s=!0),this.world.removeBody(t);return s}#bt(t){this.gnd_particle_system.M135(t),this.ball_particle_system.M135(t),this.rock_particle_system.M135(t),this.ps1.M135(t),this.ps2.M135(t),M||this.ps_snow.M135(t)}M111(t,s=null){if(t===c)this.three.M90(s.mesh);else if(5===t)this.three.M31(s.mesh);else if(2===t)this.world.addBody(s.body);else if(4===t)this.lst_rm_bodies.push(s.body);else if(3===t)this.terrain.M58(),this.character.M95(null),this.M32(),0===s.code?(this.M99("touch_trigger"),this.ball_particle_system.M146(50,s.position.x,s.position.y,s.position.z,.007),this.M100(1e3)):this.M99("touch_question");else if(6===t)this.character.M95(s.position);else if(7===t)this.M99("touch_gnd"),null!==s.p&&this.gnd_particle_system.M34(s.p.x,this.#ot+.01,s.p.z,s.n/7);else if(8===t){this.M99("touch_rock");const t=this.character.POSITION;this.M9(t.x,t.y,t.z,.009,s.n,s.hc)}else if(9===t){this.M99("jump");const t=this.character.POSITION;this.gnd_particle_system.M34(t.x,this.#ot+.02,t.z,-5,300)}else 10===t?(this.M99("fall"),this.M112(s)):11===t?this.M99("radar"):t===l&&("face"===s.key?this.M99("touch_rock"):"fail"===s.key?this.M56(s.height,s.radius):"success"===s.key?this.M27(s.height,s.radius,s.score):"stop"===s.key?(this.M65(s.score),this.question_idx<this.quizz_length?this.M100(3e3*s.score):this.M28()):"timer"===s.key&&this.M99("timer"))}M6(){this.ball_particle_system=new S("ball",S.S6,200,{size:.66,life_time:3e3,color:16766720,sprite:"./images/disc.png"}),this.three.M90(this.ball_particle_system.CONTAINER),this.rock_particle_system=new S("rock",S.S6,200,{size:.5,life_time:5e3,color:16766720,sprite:"./images/snowflake7_alpha.png"}),this.three.M90(this.rock_particle_system.CONTAINER),this.gnd_particle_system=new B(this.M111.bind(this),"gnd_shapes",B.S5,22,{life_time:7e3,shape_maker:r.CircleGeometry.bind(r),shape_args:[1,8],material_maker:r.MeshBasicMaterial.bind(r),material_options:{color:1390955,transparent:!0}}),this.ps1=new S("ps1",S.S6,50,{size:.66,life_time:5e3,color:3951965,sprite:"./images/disc.png"}),this.three.M90(this.ps1.CONTAINER),this.ps2=new S("ps2",S.S6,50,{size:.66,life_time:5e3,color:14757413,sprite:"./images/disc.png"}),this.three.M90(this.ps2.CONTAINER),M||(this.ps_snow=new S("ps_snow",S.S6,25,{size:.66,life_time:5e3,color:11584970,sprite:"./images/snowflake7_alpha.png"}),this.three.M90(this.ps_snow.CONTAINER))}M9(t,s,i,h=.01,e=100,n=null){e>0&&this.rock_particle_system.M146(e,t,s,i,h,n)}M100(t=0){this.target_cnt>0&&(this.target_cell_dst+=2/this.quizz_length,this.target_code=0===this.target_code?1:0,0===this.target_code&&(this.target_min_dtt+=2/this.quizz_length,this.character.M96(Math.round(20*this.target_min_dtt))));let s=Math.round(this.target_cell_dst),i=this.target_code;setTimeout((()=>{this.terrain.M103(14,s,{centered:1===i,code:i})}),t+500),this.target_cnt+=1;const h=this.target_cnt/(2*this.quizz_length);this.terrain.M131(h)}M64(){if(this.question_idx>=this.quizz_length)return console.warn("!",this.question_idx,this.quizz_length);this.question=!0,eById("path_node_"+(this.question_idx+1)).classList.add("current"),this.terrain.M72("add",{question_data:this.quizz_data.questions[this.question_idx],angle:this.character.ANGLE,character:this.character.M13.bind(this.character),response_time:this.quizz_data.response_time,timing_probability:this.quizz_data.timing_probability,tts:this.tts}),this.camera.M46(4.4),this.character.M47(this.terrain.M42()),this.#Mt.classList.add("hidden"),this.M129(!1)}M56(t,s){this.M99("wrong");const i=this.character.POSITION;this.gnd_particle_system.M34(i.x,this.#ot+.01+t,i.z,-2*s,333,15881030)}M27(t,s,i){const h=this.character.POSITION;1===i&&(this.M99("firework-explosion"),this.#gt+=1,this.ps1.M146(this.ps1.POOL_SIZE,h.x,h.y,h.z,Math.F2(4,6)/1e3,null,i/50),this.ps2.M146(this.ps2.POOL_SIZE,h.x,h.y,h.z,Math.F2(4,6)/1e3,null,i/50)),this.M99("correct"),this.ball_particle_system.M146(Math.round(this.ball_particle_system.POOL_SIZE*i),h.x,h.y,h.z,Math.F2(4,6)/1e3,null,i/50)}M65(t){this.question=!1,this.camera.M12(),this.character.M47(null,t,this.three.M20());const s=eById("path_node_"+(this.question_idx+1));s.classList.remove("current"),s.classList.add("done");const i=Math.round(100*t);this.question_idx+=1,this.score_quizz+=i,this.#ct.innerHTML=this.score_quizz+" / "+100*this.question_idx;const h=this.score_quizz/(100*this.question_idx)*100;if(this.#ut.innerHTML=Math.round(h)+"%",t>0){const t=this.#Mt;t.innerHTML="+"+i,t.classList.remove("no_show"),setTimeout((()=>{t.classList.add("no_show")}),7e3)}else this.M99("no_answer");this.M129(!0)}M49(){const t=this.quizz_length,s=eById("quizz_path");var i,h;for(i=0;i<=t;i++)(h=document.createElement("div")).classList.add("path_node"),h.id="path_node_"+i,s.appendChild(h)}M32(){const t=2*this.quizz_length,s=this.target_cnt/t*100;eById("quizz_path_percent").style.width=s+"%"}#wt(t){const s=eById("lives");var i,h;for(i=0;i<t;i++)(h=document.createElement("span")).classList.add("on"),h.id="life_"+(i+1),s.appendChild(h)}M112(t){if(t===1/0)return;const s=eById("life_"+(t+1));null!==s&&s.classList.remove("on"),this.dead=0===t,this.dead&&(this.M99("death"),this.M144(!0),this.M28())}M129(t){const s=t?"remove":"add";Array.from(document.querySelectorAll(".IGI")).forEach((t=>t.classList[s]("hidden")))}M28(){this.M129(!1);const t=Math.round(this.score_quizz/(100*this.question_idx)*100);var s=this.character.M2(),i="m";s>1e3&&(s/=1e3,i="km"),eById("qr_title").innerHTML=this.quizz_data.title,eById("qr_performance").innerHTML=t+"%",eById("qr_headshots").innerHTML=this.#gt+" / "+this.question_idx,eById("qr_distance").innerHTML=s+" "+i,setTimeout((()=>{eById("quizz_result").classList.add("visible")}),3e3),eById("quizz_path").style.display="none"}M84(t){null!==this.tts&&this.tts.M133(t)}}globalThis.THREE=r,globalThis.CANNON=a,globalThis.eById=t=>document.getElementById(t),window.addEventListener("load",(t=>{let s=new g;m&&(globalThis.app=s)}));class E{#xt="";#Lt=0;#It=null;#Et=0;#kt=null;#St=null;#zt=0;constructor(t,s,i=null){this.#xt=t,this.#Lt=s,null!==i&&this.M113(i)}get ID(){return this.#xt}get POOL_SIZE(){return this.#Lt}get USAGE(){return this.#zt}M113(t,s=null){this.#It=new Array(this.#Lt);for(var i,h=0;h<this.#Lt;h++)i=new t(h),this.#It[h]=i,null!==s&&s(i);this.#zt=0,this.#Et=0}M29(){if(this.#Et===this.#Lt)return null;const t=this.#It[this.#Et++];return t.FREE=!1,this.#zt=this.#Et/this.#Lt,t}M57(t){t.FREE=!0;var s=this.#Et-1,i=this.#It[t.POOL_IDX];this.#It[t.POOL_IDX]=this.#It[s],this.#It[s]=i,this.#It[t.POOL_IDX].POOL_IDX=t.POOL_IDX,this.#It[s].POOL_IDX=s,this.#Et-=1,this.#zt=this.#Et/this.#Lt}M135(t){var s,i;for(s=0;s<this.#Et;s++)(i=this.#It[s]).M33(t),i.ALIVE?this.#St&&this.#St(i,t):(this.M57(i),null!==this.#kt&&this.#kt(i))}M66(t,s){this.#kt=t||null,this.#St=s||null}M101(){var t,s;for(t=0;t<this.#Et;t++)(s=this.#It[t]).ALIVE&&s.M67(0)}}class k{#qt=0;#Tt=!0;#Ot=0;#At=0;#Pt=0;constructor(t){this.#qt=t,this.#Tt=!0}get FREE(){return this.#Tt}set FREE(t){return this.#Tt=t,this}get POOL_IDX(){return this.#qt}set POOL_IDX(t){this.#qt=t}get ALIVE(){return this.#Ot>0}get VITALITY(){return this.#Pt}M67(t){this.#Ot=t,this.#At=t,this.#Pt=1}M33(t){return this.#Ot>0&&(this.#Ot-=t,this.#Pt=this.#Ot/this.#At),this.#Ot>0}}class S extends E{static S5=1;static S6=2;#Gt=null;#Vt=null;#Ft=0;#Rt={life_time:8e3,init_x:0,init_y:1e3,init_z:0,color:5532544,size:1,sprite:null};constructor(t,i,h,e={}){super(t,h),this.#Ft=i,s(e,this.#Rt),this.M66(this.#kt.bind(this),this.#Ft===S.S6?this.#Bt.bind(this):null),this.#Ht(h)}get CONTAINER(){return this.#Gt}#Ht(t){const s=new Array(3*t).fill(0),i=new r.BufferGeometry;i.setAttribute("position",new r.Float32BufferAttribute(s,3));const h={color:this.#Rt.color,size:this.#Rt.size,transparent:Boolean(this.#Rt.sprite)};this.#Rt.sprite&&(h.map=(new r.TextureLoader).load(this.#Rt.sprite));const e=new r.PointsMaterial(h);e.depthWrite=!1,this.#Gt=new r.Points(i,e),this.#Vt=this.#Gt.geometry.getAttribute("position");const n=this.#Vt,a=this.#Rt.init_x,o=this.#Rt.init_y,l=this.#Rt.init_z,c=this.#Ft===S.S5?z:q;this.M113(c,(t=>{t.M3(n),t.M63(a,o,l)})),this.#Nt()}M135(t){super.M135(t),this.M68(t)}#Nt(){this.#Vt.needsUpdate=!0,this.#Gt.geometry.computeBoundingSphere()}#kt(t){t.M63(this.#Rt.init_x,this.#Rt.init_y,this.#Rt.init_z),this.#Nt()}M34(t,s,i){const h=super.M29();return null!==h&&(h.M63(t,s-.25,i),h.M67(this.#Rt.life_time),this.#Nt()),h}#Ct={n:0,x:0,y:0,z:0,v:0,vy:0};M146(t,s,i,h,e,n=null,r=null){this.#Ct.n=0===t?this.POOL_SIZE:Math.min(t,this.POOL_SIZE),this.#Ct.x=s,this.#Ct.y=i,this.#Ct.z=h,this.#Ct.v=e,this.#Ct.vy=r||e,null!==n&&this.#Gt.material.color.setHex(n)}M68(t){if(this.#Ct.n>0)for(;this.#Ct.n-- >0;){const t=this.M34(this.#Ct.x,this.#Ct.y,this.#Ct.z);if(null!==t){const s=Math.random()*Math.TWO_PI;t.M70(this.#Ct.v*Math.cos(s),this.#Ct.vy*Math.F2(.001,1),this.#Ct.v*Math.sin(s))}}}#Bt(t,s){t.M35(s),this.#Nt()}}class z extends k{#Dt=0;#Vt=null;constructor(t){super(t),this.#Dt=t}M3(t){this.#Vt=t}M63(t,s,i){t instanceof Array?this.#Vt.setXYZ(this.#Dt,...t):this.#Vt.setXYZ(this.#Dt,t,s,i)}M69(){return[this.#Vt.getX(this.#Dt),this.#Vt.getY(this.#Dt),this.#Vt.getZ(this.#Dt)]}M151(t){this.#Vt.setY(this.#Dt,t)}}class q extends z{#Yt=new r.Vector3;constructor(t){super(t)}M70(t,s,i){this.#Yt.set(t,s,i)}M35(t){this.#Yt.y-=1e-4;const s=this.M69();s[0]+=this.#Yt.x*t,s[1]+=this.#Yt.y*t,s[2]+=this.#Yt.z*t,this.M63(...s)}}class T{#Xt=0;#Zt=0;#Wt=0;#Ut=!0;#jt=0;#Kt=0;#Jt=0;#Qt=0;#g=0;#$t=0;#ts=null;#ss=null;#is=[];constructor(t,s,i,h=!0){this.#Xt=t,this.#Zt=s,this.#Wt=i,this.#Ut=h,this.#g=360/this.#Xt,this.#hs(),this.#es(),this.#ns(0),this.#rs()}#hs(){this.#ts=document.createElement("div"),this.#ts.classList.add("Prism"),this.#ts.style.width=this.#Zt+"px",this.#ts.style.height=this.#Wt+"px",this.#ss=document.createElement("div"),this.#ss.classList.add("PrismWrapper"),this.#ts.appendChild(this.#ss);for(var t,s=0;s<this.#Xt;++s)(t=document.createElement("div")).classList.add("PrismFace"),t.dataset.idx=s,this.#is.push(t),this.#ss.appendChild(t),t.innerHTML=s}M128(){for(;this.#is.length>0;)this.#is.pop().remove();this.#ss.remove(),this.#ss=null,this.#ts.remove(),this.#ts=null}#es(){const t=this.#Ut?this.#Zt:this.#Wt,s=this.#Ut?"Y":"X";this.#$t=this.#as(t,this.#Xt);for(var i=0;i<this.#Xt;++i)this.#is[i].style.transform=["rotate"+s+"("+-i*this.#g+"deg)","translateZ("+this.#$t+"px)"].join(" ")}#ns(t){this.#Qt=this.#os(this.#Qt+t)}#rs(){this.#ss.style.transform=["translateZ(-"+this.#$t+"px)","rotateX("+this.#jt+"deg)","rotateY("+this.#Kt+"deg)","rotateZ("+this.#Jt+"deg)"].join(" ")}#as(t,s){return Math.ceil(t/(2*Math.tan(Math.PI/s)))}#os(t){const s=this.#Xt;return(t%=s)>=0?t:t+s}#ls(t,s){return Math.floor(Math.random()*(s-t+1))+t}#cs(t){this.#jt+=t*this.#g,this.#rs()}#us(t){this.#Kt+=t*this.#g,this.#rs()}#Ms(t){const s=this.#Ut;this.#Ut=!0,s!==this.#Ut&&(this.#jt=0,this.#Kt=this.#Qt*this.#g%360,this.#es()),this.#us(t),this.#ns(t)}#ds(t){const s=this.#Ut;this.#Ut=!1,s!==this.#Ut&&(this.#Kt=0,this.#jt=this.#Qt*this.#g%360,this.#es()),this.#cs(t),this.#ns(t)}M85(){return this.#ts}M36(t){return this.#is[this.#os(t)]}M30(){return this.#is.concat()}M152(t=1){return this.#Ut?this.#Ms(t):this.#ds(t),this.#Qt}M114(){return this.#Qt}M115(t=0){if((t=this.#os(t))!==this.#Qt){const s=t-this.#Qt,i=s>0?s-this.#Xt:this.#Xt+s,h=Math.abs(i)<Math.abs(s)?i:s;this.M152(h)}return t}M37(t=!1){var s=-1;do{s=this.#ls(0,this.#Xt-1)}while(t&&s===this.#Qt);return this.M115(s)}M38(t){"number"==typeof t&&(t+="px"),this.#ts.style.perspective=t}M130(t,s){this.#Zt=t,this.#Wt=s,this.#ts.style.width=this.#Zt+"px",this.#ts.style.height=this.#Wt+"px",this.#es(),this.#ns(0),this.#rs()}M86(t){return parseInt(t.dataset.idx,10)}}const O={5:[!0,!0,!0,!0,!0],4:[!0,!0,!1,!0,!0],3:[!0,!1,!0,!1,!0],2:[!1,!0,!1,!0,!1],1:[!1,!1,!0,!1,!1]};class A{#T=null;#ps=0;#_s=.1;#ms=null;#ys=0;#gs=1;#fs=new Array(5);#V=null;#ws=null;#O=null;#bs=null;#vs=null;#xs=null;#Ls=null;#Is=!1;#Es=0;#ks=0;#Ss=null;#zs=0;#qs=0;#Ts=-1;#Os=null;#As=-1;#Ps=0;#Gs=!1;#Vs=0;#Fs=null;#Rs=!1;#Bs=new Array(5);#Hs=null;constructor(t,s,i,h,e,n){if(!this.#Ns(s))throw new Error("QuestionPod >> Invalid data");if(s.hasOwnProperty("response_time")){const t=parseInt(s.timing_probability,10);t>0&&Math.F1(t/100)&&(this.#Es=1e3*parseInt(s.response_time,10),this.#ks=this.#Es)}const a=this.#Cs(s).length;this.#V=t,this.#zs=a,this.#ps=i,this.#O=e,this.#Os=s,this.#Vs=n,this.#ms=O[a].concat(),this.#T=new r.Object3D,this.#T.rotation.y=h,this.#qs=a;const o=this.M116();this.M39(),this.#hs(o,s),this.#ws=new R(this.#Ds.bind(this),this.#ms.concat(),Math.F5(h))}#Ys(t){return t[0]}#Xs(t){return t[1]}#Cs(t){return t[2]}#Zs(t){return t[0]}#Ws(t){return t[1]}#Us(t){return t[3]}#Ns(t){return!0}get CONTAINER(){return this.#T}#hs(t,s){this.#bs=document.createElement("section"),this.#bs.id="QuestionZone",document.body.appendChild(this.#bs),this.#vs=document.createElement("div"),this.#vs.id="Question",this.#bs.appendChild(this.#vs),this.#vs.style.backgroundColor="#"+t;const h=this.#Xs(s);this.#vs.innerText=h,this.#Es>0&&(this.#Ls=document.createElement("div"),this.#Ls.id="QuestionTimer",this.#vs.appendChild(this.#Ls)),this.#Ss=new T(5,this.#bs.offsetWidth,Math.floor(.5*this.#bs.offsetHeight),!0),this.#Ss.M38(900),this.#xs=this.#Ss.M85(),this.#bs.appendChild(this.#xs);const e=this.#Us(s),n=this.#Cs(s);i(n);var r,a,o,l,c=0;for(r=0;r<5;r++)this.#ms[r]?(o=n[c],l=e===this.#Zs(o),a=this.#Ws(o),l&&(this.#As=r),window.location.host,c+=1):a="",this.#js(r,a)}M128(){for(this.#V=null,this.#Os=null,this.#Bs=null,this.#vs.remove(),this.#vs=null,this.#Ss.M128(),this.#Ss=null,null!==this.#Ls&&(this.#Ls.remove(),this.#Ls=null),this.#bs.remove(),this.#bs=null;this.#fs.length>0;){var t=this.#fs.pop();null!==t&&t.M128()}this.#fs=null,this.#ws.M128(),_(this.#Hs),this.#Hs=null,this.#T.removeFromParent(),this.#T=null}M110(t,s){this.#Ss.M130(this.#bs.offsetWidth,Math.floor(.5*this.#bs.offsetHeight))}#js(t,s){this.#Ss.M36(t).innerHTML=s,this.#Bs[t]=s}#Ds(t,s){if(t<0)this.#O(-t,s);else if(t===l)if("face"===s.key){if(0===s.status){if(this.M147(s.idx),this.#Ts===s.idx)return;this.#V(l,{key:"face"}),this.#Ks(),this.#Ss.M115(s.idx),this.#Es>0&&!this.#Is&&(this.#Is=!0,this.#V(l,{key:"timer"}));var i=this.#fs[s.idx];i.M148(!0),-1!==this.#Ts&&null!==(i=this.#fs[this.#Ts])&&i.M148(!1),this.#Ts=s.idx}}else if("select"===s.key){const t=this.#As===s.idx;this.#Ps=this.#qs/this.#zs,this.#V(l,{key:t?"success":"fail",height:this.#_s,radius:this.#ps,score:this.#Ps}),this.#qs-=1,this.M87(s.idx),t&&this.M153()}else"ready"===s.key&&(this.#Rs=!0,this.#Js(),this.M147(-1))}#Js(t=!0){this.#bs.classList[t?"add":"remove"]("visible")}#Ks(t=!0){this.#Gs?this.#xs.classList[t?"add":"remove"]("visible"):(this.#Gs=!0,setTimeout((()=>{this.#Ks(t)}),400))}M116(){const t=new r.CylinderGeometry(this.#ps,this.#ps,this.#_s,6);t.translate(0,this.#_s/2,0);const s=new r.MeshLambertMaterial;e(s.color,this.#Vs,.05);const i=new r.Mesh(t,s);return i.receiveShadow=!0,this.#T.add(i),this.#Hs=i,s.color.getHexString()}M39(){const t=2*Math.PI/6,s=.62*this.#ps;var i,h,e=t;for(i=0;i<5;++i,e+=t)this.#ms[i]?((h=new G(i,this.#ps,this.#_s,this.#Vs)).M63(s*Math.cos(e),this.#_s,s*Math.sin(e)),h.M117(e),this.#T.add(h.CONTAINER),this.#fs[i]=h):this.#fs[i]=null}M135(t,s,i,h){if(0===this.#ys){if(this.#ws.M135(t,s,i),h&&this.M147(-1),this.#Is&&this.#Es>0)if(this.#ks-=1e3/60,this.#ks>0){const t=Math.round(this.#ks/this.#Es*100);this.#Ls.style.width=t+"%"}else this.M153(!1);var e,n;for(e=0;e<5;e++)null!==(n=this.#fs[e])&&(n.M135(),n.M118()||(n.M128(),this.#fs[e]=null))}else 1===this.#ys&&(this.#gs>0?(this.#gs-=.02,this.#T.scale.setScalar(this.#gs)):(this.#ys=2,this.#V(l,{key:"stop",status:this.#ys,score:this.#Ps}),null!==this.#Fs&&this.#Fs.M140()))}M153(t=!0){this.#ys=1,this.#V(l,{key:"stop",status:this.#ys,score:t?this.#Ps:0}),this.#xs.remove(),this.#vs.remove(),this.#bs.remove()}M87(t){this.#fs[t].M154(),this.#ms[t]=!1,this.#Ss.M36(t).classList.add("wrong")}M138(t){this.#Fs=t}M147(t){var s;null!==this.#Fs&&this.#Rs&&(s=t<0?this.#Xs(this.#Os):this.#Bs[t],this.#Fs.M147(s))}M136(t){this.#ws.M136(t)}}const P=.3;class G{#xt=0;#T=null;#ps=0;#gs=0;#Qs=!0;#$s=!0;#ti=!1;#si=P;#ii=P;#hi=new r.Color(16777215);#ei=new r.Color(16766720);#Vs=0;#ni=null;#ri=null;constructor(t,s,i,h){this.#xt=t,this.#ps=s,this.#Vs=h,this.#T=new r.Object3D,this.#T.scale.setScalar(this.#gs),this.M116(),this.M148(!1)}get CONTAINER(){return this.#T}M148(t){this.#ti=t,this.#si=this.#ti?1:P}M128(){_(this.#ni),this.#ni=null,_(this.#ri),this.#ri=null,this.#T.removeFromParent(),this.#T=null}M116(){const t=.1*this.#ps,s=.22*this.#ps;var i=new r.CylinderGeometry(s,s,1,6,1,!1);i.translate(0,t/2,0);var h=new r.MeshLambertMaterial({color:this.#Vs});this.#ni=new r.Mesh(i,h),this.#ni.castShadow=!0,this.#T.add(this.#ni);const e=.66*t;(i=new r.CylinderGeometry(.2*this.#ps,.2*this.#ps,e,6)).rotateZ(Math.PI/10),i.translate(0,.9*t+e/2,0),h=new r.MeshPhongMaterial({color:this.#hi,transparent:!0,opacity:P,specular:this.#ei}),this.#ri=new r.Mesh(i,h),this.#ri.castShadow=!0,this.#T.add(this.#ri)}M63(t,s,i){this.#T.position.set(t,s,i)}M117(t){this.#T.rotation.y=-t}M135(){if(!this.#$s)return;const t=this.#si-this.#ii,s=Math.sign(t);0!==s&&Math.abs(t)>.02&&(this.#ii+=.02*s,this.#ri.material.opacity=this.#ii,this.#ri.material.color.lerpColors(this.#hi,this.#ei,(this.#ii-.5)/.5));var i=.05;if(this.#Qs){if(this.#gs>=1)return}else{if(this.#gs<=.5)return void(this.#$s=!1);i=-i,this.#ri.position.y-=.088}this.#gs+=i,this.#T.scale.setScalar(this.#gs)}M154(){this.#Qs=!1,this.M148(!1)}M118(){return this.#$s}}const V=Math.TWO_PI/6,F=Math.PI/100;class R{#ai=0;#oi=0;#g=0;#li=0;#ci=0;#ui=0;#ms=null;#V=null;#Mi=60;#di=.05;constructor(t,s,i){this.#V=t,this.#ms=s,this.#li=i,this.#ci=i,this.#g=i}M128(){this.#V=null}M135(t,s,i){this.#pi()||this.#ai===this.#oi||(this.#oi=this.#ai,this.#V(l,{key:"face",idx:this.#_i(),status:1})),this.#Mi>0?0==--this.#Mi&&this.#V(l,{key:"ready"}):t||s?this.#mi(t):i&&this.#yi()}M136(t){this.#di=3/t}#_i(){return 5-this.#ai}#pi(){const t=Math.F5(this.#li-this.#g);return!(Math.abs(t)<F||(this.#g=Math.F5(this.#g+t*this.#di),this.#V(-13,{angle:this.#g}),0))}#yi(){this.#ai<1||(this.#V(l,{key:"select",idx:this.#_i()}),this.#ms[this.#ai-1]=!1,this.#ai=this.#oi=-this.#ai)}#mi(t){const s=Date.now();s-this.#ui<500||(this.#ai=this.#gi(t),this.#V(l,{key:"face",idx:this.#_i(),status:0}),0!==this.#ai&&(this.#li=this.#ci+V*this.#ai,this.#ui=s))}#gi(t){const s=t?1:-1;var i=Math.abs(this.#ai),h=0;do{(i+=s)<1?i=5:i>5&&(i=1)}while(++h<=5&&!this.#ms[i-1]);return h>5&&(i=0),i}}class B extends E{static S5=1;static S6=2;#Ft=0;#V=null;#Rt=null;constructor(t,s,i,h,e={}){super(s,h),this.#V=t,this.#Ft=i,this.#Rt=e,this.M66(this.#kt.bind(this),this.#St.bind(this)),this.#fi(h)}#fi(t){const s=this.#Rt,i=this.#Ft===B.S5?H:N,h=new s.shape_maker(...s.shape_args),e=new s.material_maker(s.material_options);this.#Ft===B.S6&&(e.side=r.DoubleSide);const n=this.#V;this.M113(i,(t=>{const s=t.M119(h,e);n(c,{mesh:s})}))}#kt(t){t.M154(),t.M88()}#St(t,s){t.M50(),t.M71(),this.#Ft===B.S6&&t.M135(s)}M34(t,s,i,h=1,e=0,n=null){const r=super.M29();return null!==r&&(r.M63(t,s,i),r.M67(e>0?e:this.#Rt.life_time),r.M50(),r.M121(h),null!==n&&r.M120(n),r.M155()),r}M4(t,s){const i=super.M29();if(null!==i){i.M63(t.x,t.y,t.z);const h=Math.random()*Math.TWO_PI;i.M70(s[0]*Math.cos(h),Math.F2(.001,s[1]),s[0]*Math.sin(h)),i.M67(this.#Rt.life_time),i.M50(),i.M121(1),i.M120(16777215*Math.random()),i.M155()}return i}M5(t,s,i){for(;t-- >0;)this.M4(s,i)}}class H extends k{#wi=null;#Qs=!1;#gs=0;#bi=0;constructor(t){super(t)}get MESH(){return this.#wi}M119(t,s){return this.#wi=new r.Mesh(t.clone(),s.clone()),this.#bi=s.color.getHex(),this.#wi.rotation.x=-Math.HALF_PI,this.#wi.visible=this.#Qs,this.#wi}M120(t){this.#wi.material.color.setHex(t)}M63(t,s,i){this.#wi.position.set(t,s,i)}M121(t){t<0?this.#gs=t:(this.#gs=0,this.#wi.scale.set(t,t,t))}M155(){this.#wi.visible=this.#Qs=!0}M154(){this.#wi.visible=this.#Qs=!1}M88(){this.#wi.material.color.setHex(this.#bi)}M50(){this.#wi.material.opacity=this.VITALITY}M71(){if(this.#gs<0){const t=(1-this.VITALITY)*Math.abs(this.#gs);this.#wi.scale.set(t,t,t)}}}class N extends H{#vi=0;#xi=0;#Li=0;#Yt=new r.Vector3;constructor(t){super(t);const s=.02;this.#vi=Math.F2(-s,s),this.#xi=Math.F2(-s,s),this.#Li=Math.F2(-s,s)}M70(t,s,i){this.#Yt.set(t,s,i)}M135(t){this.M35(t),this.M40()}M40(t){this.MESH.rotation.x+=this.#vi,this.MESH.rotation.y+=this.#xi,this.MESH.rotation.z+=this.#Li}M35(t){this.#Yt.y-=1e-4;const s=this.MESH;s.position.x+=this.#Yt.x*t,s.position.y+=this.#Yt.y*t,s.position.z+=this.#Yt.z*t}}class C{#Ii={};constructor(){}M156(t){const s=this.#Ii[t];return void 0!==this.#Ii[t]&&(s.currentTime>0&&(s.currentTime=0),s.play().catch((t=>{})),!0)}M122(t,s=""){var i=[],h=[];t.forEach((t=>{i.push(t[0]),h.push(s+t[1])}));var e=0,n=h.map((t=>this.#Ei(t,i[e++])));return Promise.all(n).then((t=>{for(var s=t.length-1;s>=0;)this.#Ii[i[s]]=t[s],s-=1;return Promise.resolve(t.length)})).catch((t=>Promise.reject(t)))}#Ei(t,s){return this.#ki(t,s)}#ki(t,s){return this.#Si(t,s,C.TYPE_BLOB).then((t=>t.blob())).then((t=>this.#zi(t)))}#Si(t,s){return fetch(t).then((t=>{const s=t.status;return 200<=s&&s<=299?Promise.resolve(t):Promise.reject(t)})).catch((t=>Promise.reject(t)))}#zi(t){if(!t.type.startsWith("audio"))throw new Error("Sound::MakeAudioFromBlob >> BLOB type: "+t.type);const s=document.createElement("audio");return s.src=URL.createObjectURL(t),s.onload=()=>{URL.revokeObjectURL(this.src)},s}}class D{static S11=1;static S10=2;static S13=4;static S7=8;#T=null;#qi=[];#Ti=null;#Oi=0;#Ai=0;#Pi=0;#Gi=0;#Vi=0;#Fi=0;#Ri=0;#Bi=0;#Hi=0;#Ni=0;#Ci=0;#Di=null;#V=null;#Yi=null;#Xi=null;#Zi=null;#Wi=null;#Ui=0;#ji=0;constructor(t,s,i,h){this.#V=t,this.#Oi=s%2==0?s+1:s,this.#Ai=i%2==0?i+1:i,this.#Pi=h,this.#Gi=this.#Pi/2,this.#Ui=s*i,this.#Ti=new Array(Math.max(this.#Oi,this.#Ai)),this.#Vi=Math.floor(this.#Ai/2),this.#Ri=-this.#Vi,this.#Bi=Math.floor(this.#Oi/2),this.#Fi=-this.#Bi,this.#T=new r.Object3D,this.#V(c,{mesh:this.#T});const e=1/3,n=this.#Ki(e);var a,o,l,u=0;for(o=this.#Fi;o<=this.#Bi;o++)for(l=this.#Ri;l<=this.#Vi;l++)(a=new Z(this.#Ji.bind(this),u++,this.#Pi,e,o,l,n)).M74(),this.#qi.push(a);this.#Di=this.#Qi(this.#Hi,this.#Ci),this.#Di.M73()}get CENTER_BLOCK(){return this.#Di}#Ji(t,s=null){t===c?this.#T.add(s.mesh):this.#V(t,s)}#Ki(t){const s=(this.#Pi-.1)/this.#Pi;return new r.BoxGeometry(this.#Pi*s,t,this.#Pi*s).translate(0,-t/2,0)}M102(t,s){return this.#Hi=t,this.#Ci=s,this.M42()}M41(t,s,i){const h=this.#$i(t),e=this.#$i(s);var n=!1;return h!==this.#Hi&&(n=!0,this.#th(h>this.#Hi?D.S10:D.S11)),e!==this.#Ci&&(n=!0,this.#sh(e>this.#Ci?D.S13:D.S7)),n?this.#ih():null}M89(){return this.#Ni}#ih(){return this.#Di=this.#Qi(this.#Hi,this.#Ci),this.#Ni=this.#Di.Y,null!==this.#Xi&&this.#hh(),[this.#eh(this.#Hi),this.#Ni,this.#eh(this.#Ci)]}#hh(){const t=this.#Qi(this.#Xi[0],this.#Xi[1],!1);null!==t&&(this.#nh(t,this.#Zi,this.#Wi),this.#Xi=null,this.#Zi=null,this.#Wi=null)}M42(){return[this.#eh(this.#Hi),this.#Ni,this.#eh(this.#Ci)]}#th(t){this.#rh(t===D.S10?this.#Fi:this.#Bi);const s=t===D.S10?1:-1;this.#Hi+=s,this.#Fi+=s,this.#Bi+=s;const i=t===D.S10?this.#Bi:this.#Fi;this.#ah(i,null)}#sh(t){this.#oh(t===D.S13?this.#Ri:this.#Vi);const s=t===D.S13?1:-1;this.#Ci+=s,this.#Vi+=s,this.#Ri+=s;const i=t===D.S13?this.#Vi:this.#Ri;this.#ah(null,i)}#ah(t,s){for(var i,h,e=0;e<this.#Ai;e++)i=this.#Ti[e],h=Math.F1(.1)?3:this.#ji,i.M63(t,Math.F2(-h,h),s),i.M74(),i.M43()}M131(t){this.#ji=3*t,this.#qi.forEach((s=>{const i=Math.F1(.05);s.M131(i?Math.random():t,i)}))}#$i(t){return Math.floor((t+this.#Gi)/this.#Pi)}#eh(t){return t*this.#Pi}#rh(t){var s,i=0,h=0;do{(s=this.#qi[h++]).X===t&&(this.#Ti[i++]=s)}while(i<this.#Ai)}#oh(t){var s,i=0,h=0;do{(s=this.#qi[h++]).Z===t&&(this.#Ti[i++]=s)}while(i<this.#Oi)}#Qi(t,s,i=!0){var h,e;for(e=0;e<this.#Ui;e++)if((h=this.#qi[e]).X===t&&h.Z===s)return h;return null}M103(t,s=1,i=null){null===this.#Yi&&(1===s?this.#lh(t,i):this.#ch(t,s,i))}#lh(t,s){const i=this.#uh();return null!==i?(this.#nh(i,t,s),i):null}#uh(){const t=this.#Mh(1);var s,i,h;for(s=0;s<t.length;s++)if(i=t[s],!(h=this.#Qi(i[0],i[1])).M104())return h;return null}#Mh(t){var s,h,e=[];for(s=-1;s<=1;++s)for(h=-1;h<=1;++h)0===s&&0===h||e.push([this.#Hi+s*t,this.#Ci+h*t]);return i(e),e}#nh(t,s,i){this.#Yi=t,t.M103(s,i)}#ch(t,s,i){const h=this.#Mh(s).pop();this.#Xi=h,this.#Zi=t,this.#Wi=i,this.#V(6,{position:new a.Vec3(this.#eh(h[0]),this.#Ni,this.#eh(h[1]))})}M58(){null!==this.#Yi&&(this.#Yi.M58(),this.#Yi=null)}M135(t,s,i,h){this.#qi.forEach((t=>t.M135())),null!==this.#dh.pod&&this.#dh.pod.M135(t,s,i,h)}#dh={pod:null,blk:null};M72(t,s={}){if("add"===t){const t=s.question_data;t.response_time=s.response_time,t.timing_probability=s.timing_probability;const i=this.#dh.pod=new A(this.M17.bind(this),t,.8*this.#Gi,s.angle,s.character,this.#Di.COLOR_HEX);s.tts&&this.#dh.pod.M138(s.tts);const h=this.#dh.blk=this.#Di;h.M73();const e=i.CONTAINER;e.position.set(this.#eh(h.X),h.Y,this.#eh(h.Z)),this.#T.add(e)}else"fps"===t&&this.#dh.pod.M136(s)}M17(t,s){if(t===l)if("stop"===s.key)1===s.status?this.#V(l,{key:"stop",score:s.score}):(this.#dh.blk.M59(),this.#dh.blk=null,this.#T.remove(this.#dh.pod.CONTAINER),this.#dh.pod.M128(),this.#dh.pod=null);else{if("face"===s.key)return void this.#V(l,{key:"face"});this.#V(t,s)}}M110(t,s){null!==this.#dh.pod&&this.#dh.pod.M110(t,s)}}class Y extends y{#ph=0;constructor(t,s,i,h,e,n){super(t,s,i,h,e,14),this.#ph=n,this.#_h(n),this.#mh(),this.M126(n)}#_h(t){var s,i;if(0===t)s=new r.SphereGeometry(this.radius,16,16),i=new r.MeshLambertMaterial({color:16776960});else{if(1!==t)throw new Error("Invalid code: "+t);(s=new r.CylinderGeometry(1.5*this.radius,1.5*this.radius,.3*this.radius,6,1)).rotateX(Math.HALF_PI),s.rotateZ(Math.F6(30)),s.translate(0,.25*this.radius,0),i=new r.MeshPhongMaterial({color:16776960,specular:16777215})}this.M127(s,i),this.mesh.castShadow=!0}#mh(){const t=new a.Box(new a.Vec3(this.radius,this.radius,this.radius));this.M79(t)}M135(){1===this.#ph&&(this.mesh.rotation.y+=.02)}}const X=Math.F6(45);class Z{#xt=0;#yh=0;#Wt=0;#gh=null;#fh=null;#p=0;#_=0;#m=0;#wh=[];#bh=[];#V=null;#Y=null;#Vs=10145378;#gs=0;#vh=1;#xh=0;#Lh=0;#Ih=!1;#Eh=0;constructor(t,s,i,h,e,n,o){this.#xt=s,this.#yh=i,this.#Wt=h,this.#V=t,this.#gh=new r.Mesh(o,new r.MeshLambertMaterial({color:this.#Vs})),this.#gh.receiveShadow=!0,this.#gh.matrixAutoUpdate=!1,this.#V(c,{mesh:this.#gh});const l=this.#yh/2,u=new a.Vec3(l,h/2,l),M=new a.Box(u);this.#fh=new a.Body({mass:0,shape:M,collisionFilterGroup:2,collisionFilterMask:1}),this.#V(2,{body:this.#fh}),this.M63(e,0,n,!1)}get ID(){return this.#xt}get X(){return this.#p}get Y(){return this.#_}get Z(){return this.#m}M131(t,s){this.#Lh=t,this.#Ih=s,this.#Eh=X*t,this.#wh.forEach((i=>{i.M131(t,s)}))}M123(t,s=null){var i,h,e=this.#bh.length;for(null===s&&(s=this.#gh.material.clone()),i=0;i<t;i++,e++)h=new j(this.M51.bind(this),10*this.#xt+e,this.#yh,this.#Lh),this.#wh.push(h),this.#bh.push(h)}M1(){for(var t,s=0;s<this.#wh.length;s++)(t=this.#wh[s]).M44(this.#fh.position.x,this.#fh.position.y+this.#Wt/2,this.#fh.position.z),t.M43(),t.M75()}M73(t=0){var s,i;if(0!==this.#wh.length)for(t<=0&&(t=this.#wh.length),this.#xh=-t,s=0;s<t;s++)i=this.#wh.pop(),this.#kh(i),i.M128()}M59(t=!1){0!==this.#xh&&(this.#xh=Math.abs(this.#xh),t&&(this.M123(this.#xh),this.M1(),this.#Sh(1),this.#xh=0))}M63(t,s,i,h=!0){null!==t&&(this.#p=t,this.#gh.position.x=t*this.#yh,this.#fh.position.x=t*this.#yh),null!==i&&(this.#m=i,this.#gh.position.z=i*this.#yh,this.#fh.position.z=i*this.#yh),null!==this.#Y&&-1===this.#zh(s)&&(s=this.#Y.TY),this.#_=s,this.#gh.position.y=s,this.#fh.position.y=s-this.#Wt/2,h&&this.#qh(),this.#gh.updateMatrix(),this.M73(),this.M123(2),this.M1()}#qh(){this.#gs=0,this.#vh=Math.F2(.02,.1),this.#gh.scale.setScalar(0),this.#Sh(0),null!==this.#Y&&this.#Y.M141(!0)}#zh(t=null){return this.#Y.M15(this.#p,null===t?this.#_:t,this.#m)}M43(){this.#gh.rotation.y=Math.F2(-this.#Eh,this.#Eh),this.#gh.updateMatrix(),this.#fh.quaternion.set(this.#gh.quaternion.x,this.#gh.quaternion.y,this.#gh.quaternion.z,this.#gh.quaternion.w),this.#gh.updateMatrix()}M74(){e(this.#gh.material.color,this.#Vs,.05),this.#gh.updateMatrix(),this.#wh.forEach((t=>t.M74()))}get COLOR_HEX(){return this.#gh.material.color.getHex()}get MESH(){return this.#gh}M51(t,s){if(1===t)return this.#Th(s.x,s.z,s.r,s.id);this.#V(t,s)}#Th(t,s,i,h=-1){var e,n;for(e=0;e<this.#bh.length;e++)if((n=this.#bh[e]).ID!==h&&Math.F3(t,s,n.LocalX,n.LocalZ)<i+n.RADIUS)return!0;return!1}M104(){return null!==this.#Y}M103(t,s={}){s.centered&&this.M73(),14===t&&(this.#Oh(s),this.#gs<1&&this.#Y.VISIBLE&&this.#Y.M141(!0),this.#Y.M15(this.#p,this.#_,this.#m),this.#Y.M8(this.#fh.position.x,this.#fh.position.y+this.#Wt/2,this.#fh.position.z),this.#bh.push(this.#Y),s.centered&&this.M59(!0))}#Oh(t=null){var s,i;if(t&&t.centered)this.M73(),s=i=0;else{const t=this.#yh/2-.5;var h,e,n,r,a=0;RADIAL_GRID.M124();do{if(null===(n=RADIAL_GRID.M125()))throw new Error("Ball >> Cannot change position:"+a);a+=1,(e=n[1])<=t&&(h=n[0],s=e*Math.cos(h),i=e*Math.sin(h),r=!this.#Th(s,i,.5))}while(!r)}this.#Y=new Y(this.M51.bind(this),this.#bh.length,s,i,.5,t.code)}#kh(t){this.#bh.splice(this.#bh.indexOf(t),1)}M58(){this.#kh(this.#Y),this.#Y.M128(),this.#Y=null}M135(){null!==this.#Y&&this.#Y.M135(),this.#gs>=1||(this.#gs=Math.min(1,this.#gs+this.#vh),this.#gh.scale.setScalar(this.#gs),1===this.#gs&&null!==this.#Y&&this.#Y.VISIBLE&&this.#Y.M141(!1),this.#gh.updateMatrix(),this.#Sh(this.#gs))}#Sh(t){for(var s=0;s<this.#wh.length;s++)this.#wh[s].M135(t)}}const W=Math.F6(90),U=Math.F6(10);class j{#xt=0;#V=null;#wi=null;#P=null;#Wt=0;#Ah=0;#Ph=0;#Gh=0;#Vh=0;#Fh=0;#Rh=0;#Bh=0;#Hh=0;#Lh=0;#Vs=11317158;#Ih=!1;constructor(t,s,i,h){this.#V=t,this.#xt=s,this.#Bh=i/2,this.#Lh=h;const e=.1*this.#Bh,n=.66*this.#Bh,o=.1*this.#Bh,l=.9*this.#Bh,u=this.#Nh(e,n),M=this.#Nh(e,n);this.#Rh=Math.max(u,M)/2,this.#Wt=this.#Nh(o,l),this.#Hh=this.#Wt/2;const d=new r.BoxGeometry(u,this.#Wt,M);this.#wi=new r.Mesh(d,new r.MeshLambertMaterial({color:this.#Vs})),this.#wi.castShadow=!0,this.#wi.position.y=this.#Wt/2,this.#wi.matrixAutoUpdate=!1;const p=new a.Box(new a.Vec3(u/2,this.#Wt/2,M/2));this.#P=new a.Body({mass:0,shape:p,collisionFilterGroup:4,collisionFilterMask:1}),this.#P.HEX_COLOR=this.#wi.material.color.getHex(),this.#V(c,{mesh:this.#wi}),this.#V(2,{body:this.#P})}get ID(){return this.#xt}get LocalX(){return this.#Ah}get LocalZ(){return this.#Ph}get RADIUS(){return this.#Rh}#Nh(t,s){return this.#Ih||Math.F1(.2)?Math.F2(t,s):Math.F2(t,t+(s-t)*this.#Lh)}M131(t,s){this.#Lh=t,this.#Ih=s}M44(t,s,i){this.#Gh=t,this.#Vh=s,this.#Fh=i;const h=this.#Bh-this.#Rh;var e,n,r,a,o=0;RADIAL_GRID.M124();do{if(e=Math.F2(0,Math.TWO_PI),Math.random(),null===(r=RADIAL_GRID.M125()))throw new Error("Rock >> Cannot change position:"+o);o+=1,(n=r[1])<=h&&(e=r[0],this.#Ah=n*Math.cos(e),this.#Ph=n*Math.sin(e),a=!this.#V(1,{id:this.#xt,x:this.#Ah,z:this.#Ph,r:this.#Rh}))}while(!a);this.#P.position.x=this.#Gh+this.#Ah,this.#P.position.y=this.#Vh+this.#Wt/2+.001,this.#P.position.z=this.#Fh+this.#Ph,this.#wi.position.copy(this.#P.position),this.#wi.updateMatrix()}M75(){this.#wi.scale.setScalar(0)}M135(t){this.#wi.scale.setScalar(t),this.#wi.updateMatrix()}M43(){var t=this.#Lh*W;this.#wi.rotation.y=Math.F2(-t,t),t=this.#Lh*U,this.#wi.rotation.x=Math.F2(-t,t),this.#wi.rotation.z=Math.F2(-t,t),this.#wi.updateMatrix(),this.#P.quaternion.set(this.#wi.quaternion.x,this.#wi.quaternion.y,this.#wi.quaternion.z,this.#wi.quaternion.w)}M74(){e(this.#wi.material.color,this.#Vs,.05),this.#P.HEX_COLOR=this.#wi.material.color.getHex()}M128(){this.#V(4,{body:this.#P}),this.#P=null,this.#wi.removeFromParent(),this.#wi.material.dispose(),this.#wi.geometry.dispose(),this.#wi.clear(),this.#wi=null,this.#V=null}}const K=10;class J{static S1=1;static S3=1;static S2=2;static S8=1;static S9=2;#Rt={auto_resize:!0,axes:K,grid:[K,K],canvas:{id:""},renderer:{antialias:!0,clear_color:null,shadow:2,alpha:!0},camera:{fov:45,near:.1,far:100,type:J.S1,position:[K,K,K],look_at:[0,0,0]}};#Ch=null;#Dh=null;#d=null;#Yh=null;#Xh=null;#Zh=null;#Wh=0;#Uh={};#jh={};#Kh={callback:null,last_time:0,cnt:0,cnt_time:0,fn_fps:null,active:!1,id:0};#Jh={callback:null,event_listenners:!1,keys:{}};#Qh={timer:0};#$h=null;#te=0;constructor(t={}){this.#se(t)}get S8(){return this.#d}get SCENE(){return this.#Yh}#se(t={}){this.#ie(t),this.#he(),this.#Ch instanceof HTMLCanvasElement&&this.#ee(),this.#ne(),this.#re(),this.#ae(),this.#oe(),this.#le(),this.#c(),this.#Rt.auto_resize&&window.addEventListener("resize",this.#c.bind(this))}#ie(t){n(t,this.#Rt)}#he(){this.#Ch=document.getElementById(this.#Rt.canvas.id),this.#Ch,HTMLCanvasElement}#ee(){const t=this.#Rt.renderer;this.#Dh=new r.WebGLRenderer({antialias:t.antialias,alpha:t.alpha,canvas:this.#Ch}),null!==t.clear_color&&this.#Dh.setClearColor(t.clear_color),this.#Dh.shadowMap.enabled=t.shadow>0,this.#Dh.shadowMap.enabled&&2===t.shadow&&(this.#Dh.shadowMap.type=r.PCFSoftShadowMap)}#ne(){const t=this.#Rt.camera;t.type===J.S1&&(this.#d=new r.PerspectiveCamera(t.fov,this.#Wh,t.near,t.far)),this.#d.position.set.apply(this.#d.position,t.position),this.#d.lookAt.apply(this.#d,t.look_at)}#re(){this.#Yh=new r.Scene}#ae(){this.#Rt.axes>0&&(this.#Xh=new r.AxesHelper(this.#Rt.axes),this.#Xh.position.y=.001,this.#Yh.add(this.#Xh))}#oe(){this.#Rt.grid instanceof Array&&this.#Rt.grid[0]>0&&this.#Rt.grid[1]>0&&(this.#Zh=new r.GridHelper(this.#Rt.grid[0],this.#Rt.grid[1]),this.#Yh.add(this.#Zh))}M18(t){this.#$h="function"==typeof t?t:null}#c(){const t=window.visualViewport.width,s=window.visualViewport.height;this.#Wh=t/s,null!==this.#Ch&&(this.#Ch.width=t,this.#Ch.height=s),null!==this.#Dh&&this.#Dh.setSize(t,s),null!==this.#d&&(this.#d.aspect=this.#Wh,this.#d.updateProjectionMatrix()),null!==this.#$h&&this.#$h(t,s)}M139(){this.#Dh.render(this.#Yh,this.#d)}M90(t){this.#Yh.add(t)}M31(t){this.#Yh.remove(t)}M60(t,s=J.S3,i={}){if(this.#Uh.hasOwnProperty(t))return null;var h=null;return s===J.S3||"string"==typeof s&&"basic"===s.toLowerCase()?h=r.MeshBasicMaterial:(s===J.S2||"string"==typeof s&&"lambert"===s.toLowerCase())&&(h=r.MeshLambertMaterial),null===h?null:this.#Uh[t]=new h(i)}M76(t){return this.#Uh.hasOwnProperty(t)?this.#Uh[t]:null}M77(t,s,i){const h=this,e=new t(...s.map((t=>t===J.S8?h.#d:t===J.S9?h.#Ch:t)));for(var n in i)e[n]=i[n];return e}M61(t){for(var s=0;s<t.length;s++)this.#Jh.keys[t[s]]=!1;this.#ce()}#ce(){this.#Jh.event_listenners||(this.#Jh.event_listenners=!0,window.addEventListener("keydown",(t=>this.#ue(t,!0))),window.addEventListener("keyup",(t=>this.#ue(t,!1))))}#ue(t,s){this.#Jh.keys.hasOwnProperty(t.code)&&(this.#Jh.keys[t.code]=s),s&&"Escape"===t.code&&this.M7()}M132(t){return this.#Jh.keys[t]}M52(t,s){return this.#jh.hasOwnProperty(t)?null:this.#jh[t]=s}M78(t){return this.#jh.hasOwnProperty(t)?this.#jh[t]:null}M19(t,s=null){"function"==typeof t&&(this.#Kh.callback=t,"function"==typeof s&&(this.#Kh.fn_fps=s),this.#Jh.keys.Escape=!1,this.#ce())}M10(){null!==this.#Kh.callback&&(null!==this.#Kh.fn_fps&&this.#Kh.fn_fps(!0),this.#Kh.cnt=0,this.#Kh.cnt_time=0,this.#Kh.active=!0,this.#Kh.id>0&&cancelAnimationFrame(this.#Kh.id),this.#Kh.id=requestAnimationFrame(this.#Me.bind(this)))}M14(){this.#Kh.active=!1,null!==this.#Kh.fn_fps&&this.#Kh.fn_fps(!1)}M7(){null!==this.#Kh.callback&&(this.#Kh.active=!this.#Kh.active,this.#Kh.active?this.M10():this.M14())}#Me(t){this.#Kh.active&&(this.#te=t,this.#Kh.callback(t,t-this.#Kh.last_time),this.#Kh.last_time=t,this.M139(),t-this.#Kh.cnt_time>1e3?(this.#Kh.cnt>0&&null!==this.#Kh.fn_fps&&this.#Kh.fn_fps(this.#Kh.cnt),this.#Kh.cnt=0,this.#Kh.cnt_time=t):this.#Kh.cnt+=1,requestAnimationFrame(this.#Me.bind(this)))}#le(){window.addEventListener("mousemove",this.#de.bind(this)),this.#de()}#de(t){clearInterval(this.#Qh.timer),this.#Ch.style.cursor="crosshair",this.#Qh.timer=setTimeout((()=>{this.#Ch.style.cursor="none"}),1e3)}M20(){return this.#te}}class Q{static S11=0;static S10=1;static S4=2;static S12=3;#ys=[!1,!1,!1,!1];constructor(){this.#hs()}#hs(){const t=["25C0","25B6","25B2","25CF"];var s=0;["left","right","forward","jump"].forEach((i=>{const h=document.createElement("div");h.id="TouchControl_"+i,h.classList.add("TouchControl"),document.body.appendChild(h),h.innerHTML="&#x"+t[s]+";",h.addEventListener("touchstart",this.#pe.bind(this,s)),h.addEventListener("touchend",this.#_e.bind(this,s)),h.addEventListener("touchcancel",this.#me.bind(this,s)),s+=1}))}M105(t){return this.#ys[t]}#ye(t,s,i){i.cancelable&&i.preventDefault(),this.#ys[t]=s}#pe(t,s){this.#ye(t,!0,s)}#_e(t,s){this.#ye(t,!1,s)}#me(t,s){this.#ye(t,!1,s)}M155(t){Array.from(document.body.querySelectorAll(".TouchControl")).forEach((s=>{s.style.display=t?"":"none"}))}}class ${#ge=null;#a="";#fe=null;#we=1;#be=1;constructor(t="pt",s=-1,i){this.#a=t,this.#be=i,this.#ge=window.speechSynthesis,this.#ve(s)}#ve(t){const s=this.#ge.getVoices();var i,h=0;for(i of s)i.lang.split("-").includes(this.#a)&&(h===t&&(this.#fe=i),h+=1)}M147(t){if(null===this.#fe)return!1;this.M140();const s=new SpeechSynthesisUtterance(t);return s.voice=this.#fe,s.pitch=this.#we,s.rate=this.#be,this.#ge.speak(s)}M140(){this.#ge.cancel()}M133(t){this.#be=t}}